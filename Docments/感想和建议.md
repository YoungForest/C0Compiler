# 感想和建议
经过近8周的设计, 编写, 测试, 调试, 我终于完成了一个比较完整的扩展C0编译器. 经历过计组和OO的洗礼, 我们的能力有了很大的提高, 编译相对地变得可行了. 在这之前, 很难想象自己可以独立完成一个4000+行代码的工程. 当工程变得很大, 开发周期变得很长时, 很多之前注意不到的问题就会凸显出来. 比如, 如何在几周后仍然看懂自己的代码细节; 如何充分地对程序进行测试; 当修复bug或改进程序后, 如何进行回归测试, 保证自己对程序的改动没有引入新的bug. 这些都是我们在写编译时特别注意的.

1. 勤写注释, 勤写文档. 要保证自己可以在一个月后, 迅速看懂自己写的代码, 没有注释是很难做到的. 我之前的习惯是每个函数写一个注释, 注明这个函数的作用, 参数和返回值的意义. 这让我在做编译时受益颇丰. 但我发现这是不够的. 在做编译的时候, 很多情况下是, 刚开始设计的时候, 你想了很多, 什么兼容性, 可扩展性. 第二次看的时候, 有时很难会想到最初设计时的想法, 有时会把之前设计好的某些巧妙的设计否定到. 到最后需要这个巧妙的设计时, 才发现自己多么地蠢. 为了避免这个问题, 我养成设计时就撰写文档, 编写程序时随时回顾文档, 进行修改或增删. 而且写文档的时候也是思考的过程, 发现错误的过程. 这间接证明了我们学习软件工程的必要性.

2. 设计时要充分考虑最后的生成代码和优化. 否则代码生成和优化的时候会很痛苦的, 改又不舍得改, 在原先的基础上实现起来又和吃屎一样. 最后还是改了好多设计, 为了方便实现代码生成和优化.

3. 保重好自己的身体. 这句话我不知道该不该讲, 最后还是决定说出来. 克制地熬夜, 按时吃饭, 规律作息, 坚持锻炼. 这些都是拥有好身体的前提. 可惜的是, 这几点我一点都没有做到. 有一周生成目标代码时, 我理解成了要生成可执行的正确代码, 熬夜到早上6点调出来, 休息了3个小时又起来接着写文档, 当时就感到心率上升, 胸闷, 恶心, 肚子难受, 上午的篮球课都没敢去上, 就是怕猝死在篮球场上. 到了最后几周的时候, 各种结课, 大作业和考试, 熬夜成了常态, 有时甚至要刷夜. 坚持到了现在, 只剩下两门课设了, 但明显地感觉到自己的身体不如从前了. 以前认为自己年轻, 可以熬, 现在我真的不这么认为了. 生命诚可贵, 下学期我一定不会这样拼了, 保重好自己的身体才是第一位的.


比较遗憾的是, 由于之前被一些bug拖累和最后几周考试频繁, 时间紧张, 最后没有完成所有的编译优化工作.

建议是理论课可以和实验课更相关, 多讲些我们实际实现编译器时可以用到的技巧和会遇到的坑. 这可能和老师相关? 听说后大班的史晓华老师讲实验相关讲的多很多. 在实现dag优化局部公共子表达式时, 这种感觉尤为明显. 原理课中学习的dag图很简单, 按照算法来就可以完成了, 而我们实际需要的完全不是这样, 什么数组, 读写语句, 函数调用, 都需要我们自己考虑和实现. 而之前的重课, 像计组, 操作系统, 理论和实验联系都是极其紧密的, 操作系统甚至理论和实验都是一个老师带.